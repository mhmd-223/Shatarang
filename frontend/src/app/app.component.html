<div class="flex justify-between flex-col h-full">
  <ng-container
    *ngTemplateOutlet="
      topBotSectionTemp;
      context: {
        clock: playerService.blackPlayerClock,
        pieces: playerService.blackPlayerCapturedPieces,
        align: 'end',
      }
    "
  >
  </ng-container>

  <div class="flex h-full justify-between">
    <div class="w-1/4 md:w-1/5 lg:w-1/2"></div>
    <app-board class="w-full"></app-board>
    <div class="w-1/4 md:w-1/5 lg:w-1/2 flex justify-evenly">
      <div
        class="flex flex-col justify-between items-center invisible md:visible flex-grow-0"
      >
        <ng-container
          *ngTemplateOutlet="
            clockPiecesTemp;
            context: {
              color: 'b',
              clock: playerService.blackPlayerClock,
              pieces: playerService.blackPlayerCapturedPieces,
            }
          "
        ></ng-container>
        <ng-container
          *ngTemplateOutlet="
            clockPiecesTemp;
            context: {
              color: 'w',
              clock: playerService.whitePlayerClock,
              pieces: playerService.whitePlayerCapturedPieces,
            }
          "
        ></ng-container>
      </div>
    </div>
  </div>

  <ng-container
    *ngTemplateOutlet="
      topBotSectionTemp;
      context: {
        clock: playerService.whitePlayerClock,
        pieces: playerService.whitePlayerCapturedPieces,
        align: 'start',
      }
    "
  >
  </ng-container>
</div>

<ng-template
  #topBotSectionTemp
  let-clock="clock"
  let-pieces="pieces"
  let-align="align"
>
  <div class="h-full flex items-center md:h-[10%] lg:h-[1%]">
    <div [ngClass]="['self-' + align, 'flex my-2 ml-16 md:hidden']">
      <app-clock [clock]="clock"></app-clock>

      <!-- Captured pieces -->
      <div class="self-end ml-1 flex flex-wrap">
        @for (piece of pieces; track piece) {
          <img
            [src]="themeService.getPiecePath(piece)"
            alt="chessPiece"
            class="w-5 h-5 -mx-3"
          />
        }
      </div>
    </div>
  </div>
</ng-template>

<ng-template
  #clockPiecesTemp
  let-clock="clock"
  let-pieces="pieces"
  let-color="color"
>
  <div>
    @if (color === 'b') {
      <app-clock [clock]="clock"></app-clock>
    }
    <div class="grid grid-cols-5 my-3">
      @for (piece of pieces; track piece) {
        <img
          [src]="themeService.getPiecePath(piece)"
          alt="chessPiece"
          class="w-10 h-10 inline"
        />
      }
      <!-- TODO: add points difference  -->
    </div>

    @if (color === 'w') {
      <app-clock [clock]="clock"></app-clock>
    }
  </div>
</ng-template>
